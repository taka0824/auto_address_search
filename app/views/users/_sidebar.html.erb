<div class="user-info">
  <h2>User info</h2>
  <%= attachment_image_tag user, :profile_image, :fill, 100, 100, format:'jpeg',fallback: "no_image.jpg", size: "50x50" %>
  <table class="table">
    <tr>
      <th>name</th>
      <th><%= user.name %></th>
    </tr>
    <tr>
      <th>introduction</th>
      <th><%= user.introduction %></th>
    </tr>
    <tr>
      <th><%= link_to "follows", user_followings_path(user) %></th>
      <th><%= user.follower.count %></th>
    </tr>
    <tr>
      <th><%= link_to "followers", user_followers_path(user) %></th>
      <th><%= user.followed.count %></th>
    </tr>
  </table>

    <% if user != current_user %>
      <% if current_user.following?(user) %>
        <%= link_to user_relationships_path(user.id), method: :delete do %>
          <button class="btn btn-primary">フォロー外す</button>
        <% end %>
      <% else %>
        <%= link_to user_relationships_path(user.id), method: :post do %>
          <button class="btn btn-success">フォローする</button>
        <% end %>
      <% end %>
    <% end %>

    <div class="chat-container">
      <% unless @user.id == current_user.id %>
        <% if @haveRoom == true %>
          <%= link_to "ダイレクトメッセージ", room_path(@roomId) %>
        <% else %>
          <%= form_with model:@entry, local: true do |f| %>
            <%= f.hidden_field :user_id, value: @user.id %>
            <%= f.submit "ダイレクトメッセージ" %>
          <% end %>
          <%#= form_with model:@room, local: true do |f| %>
            <%#= fields_for @entry do |e| %>
              <%#= e.hidden_field :user_id, value: @user.id %>
            <%# end %>
            <%#= f.submit "ダイレクトメッセージ" %>
            <!--コントローラで受け取るものがentryに関するものなら、初めから@entryでフォーム作ったほうがいいのでは？-->
            <!--roomを作成しつつ、entryも作成したいので親子関係にあることを活かしてfields_forを使用した（親モデルのインスタンス変数を使用したフォーム内で、子モデルのレコードを作成するためのparameterを送れる）-->
            <!--roomを作成するのに必要な情報..なし、
            Entryを作成するのに必要な情報..room_id, user_id(end_user#showの@userからいただく)-->
          <%# end %>
        <% end %>
      <% end %>
    </div>

    <br>
    <br>
    <% if user.id == current_user.id %>
      <%= link_to edit_user_path(current_user.id) do %>
      	<button type="button" class="btn btn-default btn-block" aria-label="Left Align"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span></button>
      <% end %>
    <% else %>
      <%= link_to user_path(current_user.id) do %>
        <button type="button" class="btn btn-default btn-block" aria-label="Left Align"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span></button>
      <% end %>
    <% end %>


</div>

<div class="new-book">
  <h2>New book</h2>
  <%= form_with model:book, local:true do |f| %>
    <%= render "layouts/error_message", model:f.object %>
    <div class="form-group">
      <label for="InputTitle">Title</label><br>
      <%= f.text_field :title, class:"form-control", id:"InputTitle" %>
    </div>
    <div class="form-group">
      <label for="InputOpinion">Opinion</label><br>
      <%= f.text_area :body, class:"form-control", id:"InputOpinion" %>
    </div>
    <%= f.submit "Create Book",class:"btn btn-primary btn-block" %>
  <% end %>
</div>